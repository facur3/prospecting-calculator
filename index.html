<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Prospecting Calculator</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’Ž</text></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div id="error-overlay">
        <div class="error-box">
            <h2>Error de Datos</h2>
            <p>Falta <code>database.js</code></p>
        </div>
    </div>

    <script src="database.js" onerror="document.getElementById('error-overlay').style.display='flex'"></script>
    <script src="museum_data.js"></script>

    <header class="top-panel">
        <div class="header-row">
            <div class="brand">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z" />
                </svg>
                PROSPECTING CALCULATOR
            </div>

            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="calculator">Calculator</button>
                <button class="nav-tab" data-tab="museum">Museum Planner</button>
            </div>

            <div class="header-actions">
                <a href="https://prospecting.miraheze.org/wiki/Main_Page" target="_blank"
                    class="bmc-button-small wiki-btn">
                    <span>ðŸ“š Wiki</span>
                </a>
                <a href="https://buymeacoffee.com/facur33" target="_blank" class="bmc-button-small">
                    <span>â˜• Support</span>
                </a>
            </div>
        </div>

        <div class="timers-row">
            <div class="timer-card">
                <div class="timer-label">Traveling Merchant</div>
                <div class="timer-val" id="timer-merchant">--:--:--</div>
            </div>
            <div class="timer-card">
                <div class="timer-label">Infernal Heart</div>
                <div class="timer-val" id="timer-infernal">--:--:--</div>
            </div>
        </div>

        <div id="view-calculator-controls" class="controls-grid">
            <div class="control-group">
                <label>Suerte (Luck)</label>
                <input type="number" class="custom-input" id="luck" value="1" min="0.1" step="0.1" placeholder="0">
            </div>

            <div class="control-group">
                <label>Capacidad (Capacity)</label>
                <input type="number" class="custom-input" id="capacity" value="50" min="1" placeholder="0">
            </div>

            <div class="control-group dropdown-wrapper">
                <label>Buscar Mineral</label>
                <input type="text" class="custom-input" id="mineralInput" placeholder="Ej: Diamond..."
                    autocomplete="off">
                <div class="dropdown-menu" id="mineralDropdown"></div>
            </div>

            <div class="control-group dropdown-wrapper">
                <label>Rareza</label>
                <div class="custom-input" id="rarityTrigger" style="cursor: pointer;">Todas</div>
                <div class="dropdown-menu" id="rarityDropdown">
                </div>
            </div>

            <div class="control-group dropdown-wrapper">
                <label>Filtrar Zona</label>
                <input type="text" class="custom-input" id="zoneInput" placeholder="Todas las zonas..."
                    autocomplete="off">
                <div class="dropdown-menu" id="zoneDropdown"></div>
            </div>
        </div>

        <div id="view-museum-controls" class="museum-controls" style="display: none;">
            <div class="museum-summary">
                <div class="plan-selector">
                    <button class="plan-btn active" data-plan="1">Plan 1</button>
                    <button class="plan-btn" data-plan="2">Plan 2</button>
                    <button class="plan-btn" data-plan="3">Plan 3</button>
                </div>
                <div style="text-align:center; margin-bottom:10px;">
                    <button id="presets-btn" class="bmc-button-small"
                        style="display:inline-flex; background:var(--bg-card); color:var(--text-main); border:1px solid var(--border);">
                        <span>ðŸ“‹ Load Preset</span>
                    </button>
                </div>
                <div class="summary-title">TOTAL BONUSES</div>
                <div class="summary-grid" id="museum-stats-grid">
                    <!-- Stats will be injected here -->
                    <div class="stat-item empty">No bonuses active</div>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div id="view-calculator-content" class="table-wrapper">
            <table id="resultsTable">
                <thead>
                    <tr>
                        <th data-sort="location" style="width: 20%">
                            <div class="th-content">UbicaciÃ³n <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                        <th data-sort="name" style="width: 20%">
                            <div class="th-content">Mineral <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                        <th data-sort="rarity" style="width: 15%">
                            <div class="th-content">Rareza <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                        <th data-sort="value" class="text-right" style="width: 15%;">
                            <div class="th-content">Valor <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                        <th data-sort="oneIn" class="text-right" style="width: 15%;">
                            <div class="th-content">Base (1/X) <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                        <th data-sort="effort" class="text-right" style="width: 15%;">
                            <div class="th-content">Estimado <svg class="sort-icon" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path d="M7 10l5-5 5 5H7zM7 14l5 5 5-5H7z" />
                                </svg></div>
                        </th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div id="no-results">
                No se encontraron resultados. Intenta otra bÃºsqueda.
            </div>
        </div>

        <div id="view-museum-content" class="museum-content" style="display: none;">
            <div class="museum-grid" id="museum-grid">
                <!-- Slots will be injected here -->
            </div>
        </div>
    </main>

    <script src="app.js"></script>
</body>

</html>